\documentclass{article}
\usepackage{amsmath} 
\usepackage{amsfonts}
\usepackage{booktabs}
\usepackage[a4paper, margin=2.5cm]{geometry}
\usepackage{float}   % for [H]
\usepackage{graphicx}   % for \includegraphics
\usepackage{tabularx}
\usepackage[utf8]{inputenc}
\usepackage{geometry}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{blindtext}
\usepackage{hyperref}
\usepackage[round]{natbib}
\usepackage{setspace}
\usepackage{array}
\usepackage{dcolumn}
\usepackage{threeparttable}
\usepackage{tikz}
\usepackage{amsmath}
\usetikzlibrary{decorations.pathreplacing}
\usepackage{pdflscape} % in your preamble
\usepackage{tabularray}
\setcounter{secnumdepth}{2}
\usepackage{amsthm}
\usepackage{pgfplots}
\pgfplotsset{compat=1.15}
\usepackage{mathrsfs}
\usetikzlibrary{arrows}
\definecolor{ccqqqq}{rgb}{0.8,0,0}
\definecolor{ududff}{rgb}{0.30196078431372547,0.30196078431372547,1}
\definecolor{xdxdff}{rgb}{0.49019607843137253,0.49019607843137253,1}
\setlength{\parskip}{0.45em}   % space between paragraphs
\setlength{\parindent}{0pt}    % optional: remove paragraph indentation

\setlength\parindent{0pt}

\begin{document}


\title{Homework 2}
\author{Carlos Ã€lvarez, Jordi Torres}
\date{\today}

\maketitle

\section*{1}
\subsection*{1.1}

\begin{itemize}

\item $(0,0)$
\[
\Pi_{im}^M \le 0
\iff
\hat\Pi_{im}^M + \epsilon_{im} \le 0
\iff
\epsilon_{im} \le -\hat\Pi_{im}^M,
\qquad \forall i\in\{1,2\}.
\]

\item $(1,1)$
\[
\hat\Pi_{im}^D + \epsilon_{im} \ge 0
\iff
\epsilon_{im} \ge -\hat\Pi_{im}^D,
\qquad \forall i\in\{1,2\}.
\]

\item Unique entry by firm $j$ occurs when:
\begin{enumerate}
    \item
    \[
    \hat\Pi_{jm}^M + \epsilon_{jm} \ge 0
    \;\cap\;
    \hat\Pi_{-jm}^M + \epsilon_{-jm} \le 0;
    \]
    \item
    \[
    \hat\Pi_{jm}^M + \epsilon_{jm} \ge 0
    \;\cap\;
    \hat\Pi_{-jm}^M + \epsilon_{-jm} \ge 0
    \;\cap\;
    \hat\Pi_{-jm}^D + \epsilon_{-jm} \le 0.
    \]
\end{enumerate}

\item The region of multiplicity is given by
\[
-\hat\Pi_{1m}^M \le \epsilon_{1m} \le -\hat\Pi_{1m}^D
\;\cap\;
-\hat\Pi_{2m}^M \le \epsilon_{2m} \le -\hat\Pi_{2m}^D,
\]
corresponding to Region~5 in Figure~\ref{fig:equilibrium_regions}. In this region, each firm earns non-negative monopoly profits but negative
duopoly profits, so each firm prefers to enter if the rival stays out and
to stay out if the rival enters. As a result, both $(1,0)$ and $(0,1)$ are
Nash equilibria.


\end{itemize}

Figure~\ref{fig:equilibrium_regions} illustrates the partition of the
$(\epsilon_1,\epsilon_2)$ space into the nine regions described above.

\subsection*{1.2}

The remaining probabilities can be written as follows.

The probability of no entry is
\[
\mathbf{P}(D_1=0,D_2=0)
=
\int_{-\infty}^{-\pi_1^M}
\int_{-\infty}^{-\pi_2^M}
\phi_2(u_1,u_2;\rho)\,du_1\,du_2
=
\Phi_2(-\pi_1^M,-\pi_2^M;\rho).
\]

Assume now that firm~1 moves first, so that equilibrium multiplicity is resolved
in favor of outcome $(1,0)$ (Region~5 in Figure~\ref{fig:equilibrium_regions}).
Then
\[
\mathbf{P}(1,0)
=
\int_{-\pi_1^M}^{\infty}
\int_{-\infty}^{-\pi_2^D}
\phi_2(u_1,u_2;\rho)\,du_2\,du_1
=
\Phi_2(\infty,-\pi_2^D;\rho)
-
\Phi_2(-\pi_1^M,-\pi_2^D;\rho).
\]

Finally, $\mathbf{P}(0,1)$ is implied by the remaining probabilities.

\subsection*{1.3}

Table~\ref{tab:reg1} in the appendix reports estimation results obtained under
alternative sign restrictions on the correlation parameter $\rho$. The
negative log-likelihood is lower when $\rho$ is restricted to be positive,
indicating a better fit relative to the specification with negative correlation.
Coefficient estimates also differ sizeably across the two cases. In
particular, when $\rho<0$, the estimated competition effect becomes
statistically insignificant. This is consistent with the interpretation that
negative correlation in unobserved shocks reflects market-level unobservables
that favor one firm while disadvantaging the other. This reduces the ability of the
model to separately identify competitive effects from idiosyncratic
profitability differences.

Table~\ref{tab:reg2} reports estimates of $\rho$ when it is freely estimated. The
estimated value is approximately $0.3$, suggesting a moderate positive
correlation in unobserved shocks. The table also reports results obtained under
alternative assumptions about the identity of the firm that moves first. The
main differences across specifications are in the estimated competition
effect. When firm~1 (Walmart) is assumed to enter first, the estimated impact of
competition on profits is smaller.

This pattern reflects the role of $\delta$ and $\rho$ in rationalizing observed
entry decisions. When Walmart is assumed to move first, the model attributes a
larger share of entry asymmetries to differences in unobserved profitability,
which in turn implies weaker competitive effects. On the contrary, when the smaller firm is
assumed to move first, the model requires stronger competitive effects and more
similar shocks to rationalize observed outcomes.

Table~\ref{tab:reg3} confirms this interpretation. The estimated value of $\rho$
remains close to that obtained under the assumption that firm~2 moves first,
while the estimated effect of Walmart's entry on Kmarts profits increases. This
is consistent with Walmart being the larger firm, whose entry exerts a
stronger competitive pressure on Kmart.


\subsection*{1.4}

Table~\ref{tab:reg4} reports results for fixed values $\rho\in\{0.5,1\}$. In our
estimates, the negative log-likelihood is lower under $\rho=1$, indicating a
better fit when unobserved profitability shocks are (nearly) common across firms. Relative to $\rho=0.5$, the estimated competition effect is higher. This is consistent with less idiosyncratic heterogeneity being available to explain variation in entry outcomes.

Table~\ref{tab:reg5} reports results for the same model when $\rho$ is estimated
freely. In this specification, the competition effect and the correlation
parameter are not separately identified. The reason is that, in this simplified
setting, firms are symmetric in observables and the only source of
across-firm variation is the unobserved shock. Allowing $\rho$ to approach one
enables the model to rationalize the observed distribution of the number of
entrants across markets without requiring a distinct competition effect. This
results in a flat likelihood in the $(\delta,\rho)$ direction.

This lack of identification also explains why the effects of $Z_m$ cannot be
estimated in this model. Since outcomes $(1,0)$ and $(0,1)$ are aggregated into
the same category $n=1$, there is no variation in the data that distinguishes
between the identities of entering firms. In result, parameters that shift
relative profitability across firms are not identified.

Table~\ref{tab:reg6} presents results for a model with identical firms. This
specification is equivalent to the model in Part 1 under the restriction
$\rho=1$, given that perfect correlation in a bivariate normal distribution implies
identical payof shocks.

Finally, Table~\ref{tab:reg7} estimates an ordered probit for $n$. Under the
restriction $\varepsilon_1=\varepsilon_2=\varepsilon$ with $\varepsilon\sim N(0,1)$,
the model for the number of entrants is equivalent to an ordered probit with a
single latent index and two thresholds. Hence the maximum-likelihood estimates
(and the log-likelihood) coincide with those obtained from our coded likelihood.


\section*{2}

\subsection*{2.1}

The game can be summarized in 2 moment equalities and 4 moment inequalities
(or equivalently 8 inequalities). Let us start with the moment equalities:

\begin{enumerate}
    \item (1,1)  \(\rightarrow 
    \mathbf{P}(\epsilon_{1}\geq -\pi_{1}^{D},\epsilon_{2}\geq -\pi_{2}^{D}\mid X,Z,\rho )
    = \hat{P}_{1,1} 
    \rightarrow 
    M_1(\theta)= \hat{P}_{1,1} -
    \mathbf{P}(\epsilon_{1}\geq -\pi_{1}^{D},\epsilon_{2}\geq -\pi_{2}^{D}\mid X,Z,\rho )=0\)

    \item (0,0) \(\rightarrow 
    \mathbf{P}(\epsilon_{1}\leq -\pi_{1}^{M},\epsilon_{2}\leq -\pi_{2}^{M}\mid X,Z,\rho )
    = \hat{P}_{0,0} 
    \rightarrow 
    M_2(\theta)= \hat{P}_{0,0}-
    \mathbf{P}(\epsilon_{1}\leq -\pi_{1}^{M},\epsilon_{2}\leq -\pi_{2}^{M}\mid X,Z,\rho )=0\)
\end{enumerate}

Now let's consider the problematic cases $(1,0)$ and $(0,1)$. For these, we have
already shown that $P_{1,0}$ and $P_{0,1}$ cannot be point identified in the data
unless we make assumptions on equilibrium selection, because there is a region
of multiplicity where multiple equilibria can rationalize the data.

However, these probabilities are not devoid of empirical content. Consider
$(1,0)$. The probability observed in the data $\hat{P}_{1,0}(x,z)$ is bounded by
model-implied lower and upper bounds:
\[
P_{1,0}^{l}(x,z;\theta) \leq \hat{P}_{1,0}(x,z) \leq P_{1,0}^{u}(x,z;\theta),
\]
where the lower bound corresponds to regions of unique equilibrium, and the
upper bound corresponds to the case in which the equilibrium selection rule
always selects outcome $(1,0)$ in the multiplicity region. This yields two
moment inequalities:
\begin{itemize}
    \item $P_{1,0}^{l}(x,z;\theta) \leq \hat{P}_{1,0}(x,z)
    \rightarrow M_3(\theta)= \hat{P}_{1,0}(x,z)- P_{1,0}^{l}(x,z;\theta) \geq 0$
    \item $\hat{P}_{1,0}(x,z) \leq P_{1,0}^{u}(x,z;\theta)
    \rightarrow M_4(\theta)= P_{1,0}^{u}(x,z;\theta) - \hat{P}_{1,0}(x,z) \geq 0$
\end{itemize}

The same construction applies symmetrically to outcome $(0,1)$, yielding two
additional moment inequalities. In total, this yields 2 moment equalities and
4 moment inequalities (or equivalently 8 inequalities).

\subsection*{2.2}

First, the probabilities
\(\hat{P}_{1,1}(x,z), \hat{P}_{0,0}(x,z), \hat{P}_{1,0}(x,z), \hat{P}_{0,1}(x,z)\)
can be estimated nonparametrically from the data, conditional on $(X,Z)$.

Second, the remaining objects are computed using model-implied probabilities,
conditional on $(X,Z)$ and $\theta$. Specifically:
\begin{enumerate}
    \item \( p_{00}(x,z;\theta)= \Phi_{2}(-\pi_{1}^{M}(x,z;\theta),
    -\pi_{2}^{M}(x,z;\theta), \rho)\)
    \item \( p_{11}(x,z;\theta)=
    1-\Phi_2(-\pi_1^D(x,z;\theta),\infty;\rho)
    -\Phi_2(\infty,-\pi_2^D(x,z;\theta);\rho)
    +\Phi_2(-\pi_1^D(x,z;\theta),-\pi_2^D(x,z;\theta);\rho) \)
    \item For outcome $(1,0)$:
    \begin{itemize}
        \item \(P_{1,0}^{l}(x,z;\theta)=
        \Phi_{2}(\infty, - \pi_{2}^{D}(x,z;\theta), \rho)
        -\Phi_{2}(- \pi_{1}^{M}(x,z;\theta), - \pi_{2}^{D}(x,z;\theta), \rho)\)
        \item \(P_{1,0}^{u}(x,z;\theta)=
        1- p_{11}(x,z;\theta)- p_{00}(x,z;\theta)- P_{0,1}^{l}(x,z;\theta)\)
    \end{itemize}
\end{enumerate}
By symmetry, the expressions for $(0,1)$ are obtained analogously. Here
$\pi_{i}^{M}$ and $\pi_{i}^{D}$ denote monopoly and duopoly profits for firm
$i\in\{1,2\}$.

\subsection*{2.3}

We define the following criterion function:
\[
Q_n(\theta)= \int \sum_j \left[ M_j(x,z;\theta) \right]_+ \, d\hat F_{X,Z}(x,z),
\]
where $j$ indexes the set of moment (in)equalities and $[\,\cdot\,]_+$ denotes the
positive part. The criterion penalizes violations of the model-implied moment
inequalities. The identified set consists of parameter values $\theta$ for which
$Q_n(\theta)$ is close to zero.\footnote{The two moment equalities can equivalently
be written as pairs of inequalities and included in the same criterion....}

In table~\ref{fig:qtheta_hist} I report different values of Q from different values of $\theta$. Within the grid of $\theta$ we have included the parameters close the previous estimates, process that we detail better in the next section.
\subsection*{2.4}
\label{final_section}
To estimate the identified set of structural parameters, we follow the
moment-inequality approach of \textbf{Ciliberto and Tamer (2009)}, although in a much more simplified problem that has close form probability solutions. The procedure consists of the
following steps.

\begin{enumerate}

\item \textbf{Discretization of market characteristics.}  
Let $X^{c}$ denote the vector of continuous market characteristics.
We discretize the support of $X^{c}$ into two bins for each continuous variable
(dbenton, spc, population, urban). Within each bin, we replace the continuous
variable by its sample mean. This discretization induces a finite support for
$(X,Z)$ and allows for nonparametric estimation of conditional choice
probabilities.

\item \textbf{Nonparametric estimation of conditional probabilities.}  
For each combination $(x,z)$ in the discretized support of $(X,Z)$, we estimate
the conditional distribution of market outcomes nonparametrically:
\[
\hat P_n(Y = y \mid X = x, Z = z)
=
\frac{\sum_{i=1}^{n} \mathbf{1}\{Y_i = y, X_i = x, Z_i = z\}}
     {\sum_{i=1}^{n} \mathbf{1}\{X_i = x, Z_i = z\}},
\qquad y \in \{(1,1),(1,0),(0,1),(0,0)\}.
\]
Each distinct realization of $(x,z)$ defines a market type in the estimation
sample. For each market type, we therefore obtain four empirical conditional
probabilities $(\hat p_{11}, \hat p_{10}, \hat p_{01}, \hat p_{00})$.

\item \textbf{Construction of model-implied moments.}  
Let $\theta$ denote the vector of structural parameters, which includes
coefficients on market characteristics, firm-specific intercepts, the common
competition effect, and the correlation parameter of the payoff shocks.\footnote{
Specificaly, $\theta$ includes coefficients on population, spc, urban, and
dbenton; regional indicators; a common competition parameter; firm-specific
intercepts; and the correlation parameter $\rho$.
}
For a given $\theta$:

\begin{enumerate}

\item We compute monopoly and duopoly profit indices,
$\pi_i^M(x,z;\theta)$ and $\pi_i^D(x,z;\theta)$, using the specified linear
profit functions.

\item Assuming jointly normal payoff shocks, we compute the model-implied
probabilities for each market type:
\[
p_{11}(\theta), \quad p_{00}(\theta), \quad
p_{10}^L(\theta), \quad p_{10}^U(\theta), \quad
p_{01}^L(\theta), \quad p_{01}^U(\theta),
\]
where $p_{10}^L(\theta)$ and $p_{01}^L(\theta)$ denote the lower bounds implied by
regions of unique equilibrium, and $p_{10}^U(\theta)$ and $p_{01}^U(\theta)$ denote
the corresponding upper bounds implied by equilibrium multiplicity.

\item We construct a vector of moment conditions $m(\theta \mid x,z)$ that
enforces equality restrictions for outcomes $(1,1)$ and $(0,0)$ and inequality
restrictions for outcomes $(1,0)$ and $(0,1)$.

\end{enumerate}

\item \textbf{Criterion function.}  
We define the sample criterion function as
\[
Q_n(\theta)
=
\int H\!\left(m(\theta \mid x,z)\right)_+ \, d\hat F_{X,Z}(x,z),
\]
where $H(\cdot)_+$ denotes a nonnegative loss function that penalizes violations
of the moment inequalities, and $\hat F_{X,Z}$ is the empirical distribution of
$(X,Z)$. The identified set is approximated by the collection of parameter values
$\theta$ for which $Q_n(\theta)$ is close to zero.

Given the size \(\theta\) we define the grid of parameters using a Uniform distribution for each parameter\footnote{Doing usual grid search is unfeasible given the dimension of the parameter space we have.}. We take previous models as reference, and define bounds on the uniform to include them. We run $2000$ simulations of $\theta$.

\textbf{Inference}
Due to time constraints, we do not implement formal inference procedures for
moment inequalities, such as CCK or CHT. Instead, as a simple approximation, we
define the identified set as the collection of parameter values satisfying
\( Q_n(\theta) \le \min Q_n(\theta) + \varepsilon \), where $\varepsilon$ is small. We then compute the minimum
and maximum of each parameter over this set. The resulting parameter ranges are
reported in Table~\ref{tab:identified_set}. All parameter estimates obtained in
the previous models lie within this approximate identified set. Nevertheless,
this procedure is heuristic: the choice of \(\varepsilon\) is ad hoc, and the
resulting set does not account for sampling uncertainty, so it should not be
interpreted as a confidence region.


\end{enumerate}



\section*{Appendix}



\begin{figure}[H]
\centering
\includegraphics[width=0.7\textwidth]{graph_areas.png}
\caption{Equilibrium regions.}
\label{fig:equilibrium_regions}
\end{figure}



\begin{table}[H]
\centering
\caption{Results: 1.3}
\label{tab:reg1}

\input{1_3.tex}

\end{table}

\begin{table}[H]
\centering
\caption{Results: 1.3.2}
\label{tab:reg2}

\input{1_3_2.tex}

\end{table}

\begin{table}[H]
\centering
\caption{Results: 1.3.3}
\label{tab:reg3}

\input{1_3_3.tex}

\end{table}

\begin{table}[H]
\centering
\caption{Results: 1.4.1}
\label{tab:reg4}

\input{1.4_1.tex}

\end{table}


\begin{table}[H]
\centering
\caption{Results: 1.4.2}
\label{tab:reg5}

\input{1.4_2.tex}

\end{table}


\begin{table}[H]
\centering
\caption{Results: 1.4.3}
\label{tab:reg6}

\input{1.4_3.tex}

\end{table}


\begin{table}[H]
\centering
\caption{Results:1.4.4}
\label{tab:reg7}

\input{1.4_4.tex}

\end{table}


\begin{figure}[H]
\centering
\includegraphics[width=0.7\textwidth]{distribution_Q.png}
\caption{Distribution of the criterion function $Q(\theta)$.}
\label{fig:qtheta_hist}
\end{figure}


\begin{table}[H]
\centering
\begin{threeparttable}
\caption{Approximate Identified Set of Structural Parameters}
\label{tab:identified_set}

\begin{tabular}{ccc}
\hline
\textbf{Parameter} & \textbf{Min} & \textbf{Max} \\
\hline
$\beta_{\text{pop}}$        & 1.40569  & 1.99906  \\
$\beta_{\text{spc}}$        & 1.10293  & 1.98810  \\
$\beta_{\text{urban}}$      & 1.00291  & 1.99870  \\
$\beta_{w,\text{dbenton}}$  & -1.19880 & -0.80090 \\
$\beta_{w,\text{southern}}$ & 0.30102  & 0.69919  \\
$\beta_{k,\text{midwest}}$  & 0.10561  & 0.49987  \\
$\delta_w$                  & -2.98758 & -0.52508 \\
$\delta_k$                  & -2.98568 & -0.55323 \\
$\rho$                      & -0.99134 & 0.97698  \\
$\alpha_k$                  & -46.9846 & -9.41134 \\
$\alpha_w$                  & -49.5815 & -5.98668 \\
\hline
\end{tabular}

\begin{tablenotes}
\footnotesize
\item \emph{Notes:} The table reports minimum and maximum parameter values among
parameter draws for which the criterion function $Q_n(\theta)$ lies within a
fixed tolerance of its minimum on a finite parameter grid. This procedure
approximates the identified set and is not intended to provide formal
statistical inference. 
\end{tablenotes}

\end{threeparttable}
\end{table}




\end{document}